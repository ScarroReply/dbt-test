# models/staging/stg_dwh__paghe_fatture.yml

version: 2

models:
  - name: stg_dwh__paghe_fatture
    description: "Tabella di staging che fornisce una vista pulita e standardizzata dei dati di paghe e fatture. Le colonne sono rinominate per chiarezza e per aderire alle convenzioni di denominazione (snake_case)."
    config:
      materialized: view  # Questo modello sarà una vista in BigQuery, garantendo dati sempre aggiornati.

    columns:
      - name: paghe_fatture_id
        description: "Chiave surrogata univoca per ogni riga di paghe e fatture."
        tests:
          - unique
          - not_null
      - name: azienda
        description: "Nome o codice standardizzato dell'azienda."
        tests:
          - not_null
      - name: anno
        description: "Anno di riferimento dei dati (es. 2023)."
        tests:
          - not_null
      - name: mese
        description: "Mese di riferimento dei dati (01-12)."
        tests:
          - not_null
      - name: matricola
        description: "Matricola o ID univoco del dipendente all'interno dell'azienda per un dato periodo."
      - name: gg_lav
        description: "Numero di giorni effettivamente lavorati nel mese."
        tests:
          - not_null
      - name: gg_retr
        description: "Numero di giorni retribuiti nel mese."
      - name: hh_lav
        description: "Numero di ore effettivamente lavorate nel mese."
      - name: hh_retr
        description: "Numero di ore retribuite nel mese."
      - name: stipendio
        description: "Importo dello stipendio lordo."
        tests:
          - not_null
      - name: retrib_tfr
        description: "Retribuzione di riferimento per il calcolo del TFR (Trattamento di Fine Rapporto)."
      - name: impon_imps
        description: "Imponibile fiscale per il calcolo delle imposte."
      - name: netto
        description: "Importo netto percepito dal dipendente, dopo deduzioni e contributi."
        tests:
          - not_null
      - name: costo_retr
        description: "Costo totale della retribuzione per l'azienda."
      - name: ctr_retr
        description: "Contributi previdenziali e assistenziali a carico del datore di lavoro sulla retribuzione."
      - name: inail_retr
        description: "Contributo INAIL calcolato sulla retribuzione."
      - name: ratei
        description: "Importo relativo a ratei (es. tredicesima, quattordicesima) maturati nel mese."
      - name: ctr_ratei
        description: "Contributi sociali sui ratei."
      - name: inail_ratei
        description: "Contributo INAIL sui ratei."
      - name: tfr
        description: "Importo effettivo del TFR maturato nel mese o erogato."
      - name: ebi_form_retr
        description: "Contributi EBI (Enti Bilaterali) su retribuzione."
      - name: ebi_form_ratei
        description: "Contributi EBI su ratei."
      - name: rimb_spese
        description: "Importi rimborsati al dipendente per spese sostenute."
      - name: trasferte
        description: "Importo delle trasferte del dipendente."
      - name: ctr_trasferte
        description: "Contributi sociali sulle trasferte."
      - name: una_tantum
        description: "Importi erogati una tantum."
      - name: ctr_una_tantum
        description: "Contributi sociali su importi una tantum."
      - name: premio_decontrib
        description: "Importo del premio decontribuito (esente da alcune tasse)."
      - name: ctr_decontrib
        description: "Contributi associati al premio decontribuito."
      - name: ctr_auto
        description: "Contributi relativi all'uso dell'auto aziendale."
      - name: arretrati
        description: "Importo degli arretrati."
      - name: ctr_arretrati
        description: "Contributi sociali sugli arretrati."
      - name: arretrati_ap
        description: "Importo degli arretrati AP (Annualità Precedenti)."
      - name: ctr_arr_ap
        description: "Contributi sociali sugli arretrati AP."
      - name: una_tantum_ap
        description: "Importo una tantum AP (Annualità Precedenti)."
      - name: ctr_tantum_ap
        description: "Contributi sociali su importo una tantum AP."
      - name: causale_90
        description: "Valore per causale 90 (specifica da definire in base al contesto aziendale)."
      - name: causale_91
        description: "Valore per causale 91 (specifica da definire in base al contesto aziendale)."
      - name: ctr_caus_90_91
        description: "Contributi relativi alle causali 90/91."
      - name: causale_92
        description: "Valore per causale 92 (specifica da definire in base al contesto aziendale)."
      - name: ctr_caus_92_96
        description: "Contributi relativi alle causali 92/96."
      - name: causale_93
        description: "Valore per causale 93 (specifica da definire in base al contesto aziendale)."
      - name: causale_94
        description: "Valore per causale 94 (specifica da definire in base al contesto aziendale)."
      - name: causale_96
        description: "Valore per causale 96 (specifica da definire in base al contesto aziendale)."
      - name: causale_99
        description: "Valore per causale 99 (specifica da definire in base al contesto aziendale)."
      - name: rival_ratei
        description: "Rivalutazione dei ratei."
      - name: contrib_riv_ratei
        description: "Contributi sulla rivalutazione dei ratei."
      - name: ind_dispon
        description: "Indennità di disponibilità."
      - name: dbt_loaded_at
        description: "Timestamp di quando il modello è stato processato e caricato da dbt nel data warehouse."
        tests:
          - not_null